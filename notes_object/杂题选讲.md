# 杂题选讲

## [P14838 [THUPC 2026 初赛] 序列](https://www.luogu.com.cn/problem/P14838)

对于这种看似没有抓手的题目，我们尝试从极端情况入手，抓住最值。

我们看这个环中的最大值，可以发现它左右两边的值是确定的而且是一样的。

同时由于两边的贡献是一样的，所以一定贡献的是二的偶数幂次（这时我们会发现实际上偶数的都不行了，我是先发现的这个结论再想到前面那个算法的，当然你厉害的话可以反过来）

而我们发现实际上这个环可以被我们缩掉了，但是注意，现在我们要求缩出来的这个环有一个固定的数，想要用递归处理这个问题，如果我们原先的m是最大值那就很好了，如果不是，就一直缩到他是为止，这是不劣的。

然后我们得到了O(n)的算法，如何优化？如何写？

剪枝的简洁写法。

## [2025 ICPC Asia East Continent Online Contest L. Xor Mirror](https://qoj.ac/contest/2524/problem/14325)

区间异或转移，求和

可以尝试使用线段树，这里给出一个在时间复杂度允许的情况下，更好想更好写的方法。尝试使用分块，注意一定是按2的幂次分块，那么每次的异或转移，对于大块的而言，一定都是转移到了另一个大块上，但是同时内部也会发生变化，而内部的变化可以用一个数来维护，我们先把块都存下来，对于大块而言，每个大块建立一个索引和内部偏移量，去指向我们存下来的位置，每次大块的覆盖，先把索引指过去，再改变内部偏移量，对于散块，每次重构之后，重新找个位置存下来，并把索引指向新的这个位置即可。同时注意下内存的回收就好了。

细节挺多的，下来慢慢写吧。

## [2024 CCPC Zhengzhou D. Guessing Game](https://qoj.ac/contest/1873/problem/9771)

理解题意--给出多项式复杂度做法--正解看看（如何做一道复合的题目，体会题目的美妙，如何出一道不僵硬而复合的题目）

给定$a_i,b_i$,你选择一个$i$，并告诉A $a_i$,告诉B $b_i$，如何AB轮流猜对方是啥，只有有把握了才会猜，看样例尝试理解这个博弈。可能会出现一直猜不出来的情况。

对于每个你选择的$i$，统计谁赢谁输，输出两个人输赢的局数。

前缀多次询问。

显然，我们把这个问题放在图上看。

对于A而言，每次B的不回答都是在图上删除B的度数为1的点。

B也类似。

两者会不断删点直到那个$a_i/b_i$入度为1。

也就是对于每个前缀不断的删点，如果$a_i$比$b_i$先删掉那就是A的否则就是B的，如果都删不掉就无贡献。

这时候我们已经得到一个平方的算法了。

如何优化这个平方的算法？

问题在于新加入的点会让前面的点删不掉了。

而如果我们倒过来考虑，删掉的点倒是都能找到，但是无法比较$a_i,b_i$的删除时间。

画一下图，我们会发现实际上就是在强连通分量上挂了一堆树。同时注意到$a_i,b_i$也是联通的。

我们模拟一下会发现我们并不关心树到底长成啥样，因为树上的点的贡献都一定会是1。

于是我们只关心强连通分量，也就是删不掉的那些点的颜色。

但是如果这张图没有一个中心的强连通分量呢，那相当于是在往中间删，也就是要去找树的重心，如果有两个就是B那个最后留下，因为A先手，而动态树的重心是简单的，甚至你不用关心重心到底是那个点，只用关心直径的长度和两头点的颜色就好了。

具体怎么求，先把最后图的一棵生成树求出来，然后当合并两棵树的时候，直径的端点从两棵树直径的端点中选，距离就用生成树上的距离。

这道题揉进去了很多知识点，但是又不牵强，我觉得是一道非常好的题，可遇不可求。

